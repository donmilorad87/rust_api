{% extends "base.html" %}

{% block title %}User Management - Blazing Sun Admin{% endblock %}

{% block extra_styles_links %}
<link rel="stylesheet" href="/assets/css/REGISTERED_USERS/style.css?v={{ assets_version }}">
{% endblock %}

{% block content %}
<main class="admin-content">
    <div class="users-page">
        <header class="users-page__header">
            <h1 class="users-page__title">Registered Users</h1>
            <div class="users-page__controls">
                <div class="bulk-actions">
                    <label class="bulk-actions__label" for="bulkActionSelect">Bulk Actions</label>
                    <select id="bulkActionSelect" class="bulk-actions__select" aria-label="Bulk actions">
                        <option value="">Select action</option>
                        <option value="delete">Delete selected</option>
                        <option value="set_permissions">Change permissions</option>
                    </select>
                    <select id="bulkPermissionSelect" class="bulk-actions__select bulk-actions__select--hidden" aria-label="Bulk permission">
                        <option value="">Select permission</option>
                        <option value="1">Basic</option>
                        <option value="10">Admin</option>
                        <option value="50">Affiliate</option>
                        <option value="100">Super Admin</option>
                    </select>
                    <button type="button" id="bulkApplyBtn" class="btn btn--primary btn--hidden" disabled>Apply</button>
                </div>
                <div class="search-input">
                    <svg class="search-input__icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" id="searchInput" class="search-input__field" placeholder="Search users..." aria-label="Search users">
                </div>
            </div>
        </header>

        {% if stats %}
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-card__label">Total Users</div>
                <div class="stat-card__value">{{ stats.total }}</div>
            </div>
            <div class="stat-card">
                <div class="stat-card__label">Active Users</div>
                <div class="stat-card__value">{{ stats.active }}</div>
            </div>
            <div class="stat-card">
                <div class="stat-card__label">Admins</div>
                <div class="stat-card__value">{{ stats.admins }}</div>
            </div>
        </div>
        {% endif %}

        <div class="table-container">
            <table class="users-table" role="grid" aria-label="Users table">
                <thead class="users-table__head">
                    <tr>
                        <th class="users-table__header users-table__header--center" scope="col">
                            <input type="checkbox" id="selectAllUsers" class="table-checkbox" aria-label="Select all users">
                        </th>
                        <th class="users-table__header" scope="col">ID</th>
                        <th class="users-table__header" scope="col">Email</th>
                        <th class="users-table__header" scope="col">Name</th>
                        <th class="users-table__header" scope="col">Permission</th>
                        <th class="users-table__header" scope="col">Status</th>
                        <th class="users-table__header" scope="col">Balance</th>
                        <th class="users-table__header" scope="col">Joined</th>
                        <th class="users-table__header users-table__header--center" scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody id="usersTable" class="users-table__body">
                    {# Populated by JavaScript #}
                    <tr>
                        <td colspan="9" class="users-table__empty">
                            <div class="empty-state">
                                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" y1="8" x2="12" y2="12"></line>
                                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                </svg>
                                <p>Loading users...</p>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="pagination" class="pagination-container"></div>
    </div>
</main>

<div id="confirmModal" class="confirm-modal" aria-hidden="true">
    <div class="confirm-modal__backdrop z-modal-backdrop" data-action="close-modal"></div>
    <div class="confirm-modal__dialog z-modal" role="dialog" aria-modal="true" aria-labelledby="confirmModalTitle">
        <header class="confirm-modal__header">
            <h2 id="confirmModalTitle" class="confirm-modal__title">Confirm action</h2>
            <button type="button" class="confirm-modal__close" data-action="close-modal" aria-label="Close">
                x
            </button>
        </header>
        <div class="confirm-modal__body">
            <p id="confirmModalMessage" class="confirm-modal__message">Are you sure?</p>
        </div>
        <div class="confirm-modal__actions">
            <button type="button" class="btn btn--ghost" data-action="cancel-modal">Cancel</button>
            <button type="button" class="btn btn--danger" data-action="confirm-modal">Confirm</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Set base URL for API requests
    window.BASE_URL = '{{ base_url | safe }}';
</script>
<script src="/assets/js/REGISTERED_USERS/app.js?v={{ assets_version }}" defer></script>
{% endblock %}
