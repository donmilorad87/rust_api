{% extends "base.html" %}

{% block title %}Forgot Password - Blazing Sun{% endblock %}

{% block extra_styles_links %}
<link rel="stylesheet" href="/assets/css/FORGOT_PASSWORD/style.css?v={{ assets_version }}">
{% endblock %}

{% block content %}
<main class="container">
    <!-- Request Reset Form -->
    <article class="card" id="requestCard">
        <h1>Forgot Password</h1>
        <p class="text-center" style="color: #666; margin-bottom: 1.5rem;">
            Enter your email address and we'll send you a code to reset your password.
        </p>
        <form id="requestForm" aria-label="Request password reset form">
            <div class="form-group">
                <label for="email">Email</label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    autocomplete="email"
                    aria-required="true"
                >
            </div>
            <button type="submit" class="btn" id="requestBtn">Send Reset Code</button>
        </form>
        <p class="text-center mt-1">
            Remember your password? <a href="/sign-in" class="link">Sign In</a>
        </p>
    </article>

    <!-- Verify Hash Form (hidden initially) -->
    <article class="card hidden" id="verifyCard">
        <h1>Verify Code</h1>
        <p class="text-center" style="color: #666; margin-bottom: 1.5rem;">
            We've sent a reset code to your email. Please enter it below to continue.
        </p>
        <form id="verifyForm" aria-label="Verify reset code form">
            <div class="form-group">
                <label for="reset_code">Reset Code</label>
                <input
                    type="text"
                    id="reset_code"
                    name="reset_code"
                    required
                    maxlength="20"
                    placeholder="Enter 20 character code"
                    autocomplete="one-time-code"
                    aria-required="true"
                >
            </div>
            <input type="hidden" id="verify_email" name="email">
            <button type="submit" class="btn" id="verifyBtn">Verify Code</button>
        </form>
    </article>

    <!-- Reset Password Form (hidden initially) -->
    <article class="card hidden" id="resetCard">
        <h1>Reset Password</h1>
        <p class="text-center" style="color: #666; margin-bottom: 1.5rem;">
            Code verified! Please enter your new password.
        </p>
        <form id="resetForm" aria-label="Reset password form">
            <div class="form-group">
                <label for="new_password">New Password</label>
                <input
                    type="password"
                    id="new_password"
                    name="password"
                    required
                    minlength="8"
                    autocomplete="new-password"
                    aria-required="true"
                >
            </div>
            <div class="form-group">
                <label for="confirm_password">Confirm Password</label>
                <input
                    type="password"
                    id="confirm_password"
                    name="password_confirmation"
                    required
                    autocomplete="new-password"
                    aria-required="true"
                >
            </div>
            <input type="hidden" id="reset_token" name="token">
            <input type="hidden" id="reset_email" name="email">
            <button type="submit" class="btn" id="resetBtn">Reset Password</button>
        </form>
    </article>
</main>
{% endblock %}

{% block scripts %}
<script>
    // Set base URL for API requests
    window.BASE_URL = '{{ base_url | safe }}';
</script>
<script src="/assets/js/FORGOT_PASSWORD/app.js?v={{ assets_version }}" defer></script>
{% endblock %}
