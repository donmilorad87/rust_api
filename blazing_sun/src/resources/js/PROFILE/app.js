(function(){"use strict";var m=document.createElement("style");m.textContent=`.profile{min-height:calc(100vh - 60px);padding:2rem;background:var(--bg-primary)}.profile__container{max-width:900px;margin:0 auto}.profile__header{margin-bottom:2rem}.profile__title{font-size:1.5rem;font-weight:700;color:var(--text-primary);margin:0}.profile__grid{display:grid;gap:2rem}@media (min-width: 768px){.profile__grid{grid-template-columns:300px 1fr}}.profile-card{background:var(--card-bg);border-radius:8px;padding:2rem;box-shadow:0 4px 20px var(--card-shadow);transition:box-shadow .3s ease}.profile-card:hover{box-shadow:0 6px 24px var(--card-shadow)}.profile-card__title{font-size:1.125rem;font-weight:600;color:var(--text-primary);margin:0 0 1.5rem;padding-bottom:1rem;border-bottom:1px solid var(--border-color)}.avatar-section{display:flex;flex-direction:column;align-items:center}.avatar{position:relative;width:120px;height:120px;margin-bottom:1.5rem}.avatar__image{width:100%;height:100%;border-radius:50%;object-fit:cover;border:4px solid var(--border-color);transition:border-color .3s ease}.avatar__placeholder{width:100%;height:100%;border-radius:50%;background:var(--avatar-placeholder-bg, #e5e7eb);display:flex;align-items:center;justify-content:center;color:var(--avatar-placeholder-color, #9ca3af);border:4px solid var(--border-color)}.avatar__placeholder svg{width:60%;height:60%}.avatar__overlay{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:50%;background:#00000080;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease;cursor:pointer}.avatar__overlay:hover{opacity:1}.avatar__overlay-icon{width:32px;height:32px;color:#fff}.avatar__input{display:none}.avatar__name{font-size:1.125rem;font-weight:600;color:var(--text-primary);margin-bottom:.25rem}.avatar__email{font-size:.875rem;color:var(--text-muted)}.avatar-preview{position:fixed;top:0;right:0;bottom:0;left:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:200;padding:2rem}.avatar-preview.hidden{display:none}.avatar-preview__container{background:var(--card-bg);border-radius:8px;padding:2rem;max-width:400px;width:100%}.avatar-preview__image{width:200px;height:200px;border-radius:50%;object-fit:cover;margin:0 auto 1.5rem;display:block;border:4px solid var(--border-color)}.avatar-preview__actions{display:flex;gap:1rem;justify-content:center}.form-section{margin-bottom:2rem}.form-section:last-child{margin-bottom:0}.form-section__title{font-size:1rem;font-weight:600;color:var(--text-secondary);margin:0 0 1rem;text-transform:uppercase;letter-spacing:.5px}.form-group{margin-bottom:1rem}.form-group:last-child{margin-bottom:0}.form-group__label{display:block;font-size:.875rem;font-weight:500;color:var(--text-secondary);margin-bottom:.25rem}.form-group__input{width:100%;padding:.75rem 1rem;border:2px solid var(--input-border);border-radius:6px;background:var(--input-bg);color:var(--text-primary);font-size:1rem;font-family:inherit;transition:border-color .3s ease,box-shadow .3s ease}.form-group__input:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea33}.form-group__input:disabled{opacity:.6;cursor:not-allowed}.form-group__input::placeholder{color:var(--text-muted)}.form-group__hint{font-size:.875rem;color:var(--text-muted);margin-top:.25rem}.form-group__error{font-size:.875rem;color:#ef4444;margin-top:.25rem}.form-row{display:grid;gap:1rem}@media (min-width: 480px){.form-row{grid-template-columns:repeat(2,1fr)}}.btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.75rem 1.5rem;border:none;border-radius:6px;font-size:1rem;font-weight:600;font-family:inherit;cursor:pointer;transition:all .3s ease;text-decoration:none}.btn:disabled{opacity:.6;cursor:not-allowed}.btn--primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn--primary:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn--secondary{background:var(--btn-secondary-bg);color:var(--text-primary);border:2px solid var(--border-color)}.btn--secondary:hover:not(:disabled){border-color:#667eea;color:#667eea}.btn--danger{background:#ef4444;color:#fff}.btn--danger:hover:not(:disabled){background:#d93636}.btn--sm{padding:.5rem 1rem;font-size:.875rem}.btn--loading{pointer-events:none;opacity:.8}.btn--full{width:100%}.password-strength{margin-top:.5rem}.password-strength__track{height:4px;background:var(--border-color);border-radius:2px;overflow:hidden}.password-strength__bar{height:100%;width:0;transition:width .3s ease,background .3s ease}.password-strength__bar--weak{width:25%;background:#ef4444}.password-strength__bar--fair{width:50%;background:#f59e0b}.password-strength__bar--good{width:75%;background:#84cc16}.password-strength__bar--strong{width:100%;background:#10b981}.password-strength-text{font-size:.875rem;margin-top:.25rem;color:var(--text-muted)}.email-steps{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-bottom:2rem}.email-step{display:flex;align-items:center;gap:.5rem}.email-step__number{width:28px;height:28px;border-radius:50%;background:var(--border-color);color:var(--text-muted);font-size:.875rem;font-weight:600;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.email-step__label{font-size:.875rem;color:var(--text-muted);transition:color .3s ease}@media (max-width: 480px){.email-step__label{display:none}}.email-step--active .email-step__number{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.email-step--active .email-step__label{color:var(--text-primary);font-weight:500}.email-step--completed .email-step__number{background:#10b981;color:#fff}.email-step__connector{width:30px;height:2px;background:var(--border-color)}@media (max-width: 480px){.email-step__connector{width:20px}}.section-divider{height:1px;background:var(--border-color);margin:2rem 0}.message-box{padding:1rem;border-radius:6px;margin-bottom:1.5rem}.message-box--info{background:#667eea1a;border:1px solid rgba(102,126,234,.3);color:var(--text-primary)}.message-box--success{background:#10b9811a;border:1px solid rgba(16,185,129,.3);color:#10b981}.message-box--warning{background:#f59e0b1a;border:1px solid rgba(245,158,11,.3);color:var(--text-primary)}.message-box--error{background:#ef44441a;border:1px solid rgba(239,68,68,.3);color:#ef4444}@media (max-width: 768px){.profile{padding:1rem}.profile__grid{grid-template-columns:1fr}.profile-card{padding:1.5rem}}@media (max-width: 480px){.profile{padding:.5rem}.avatar{width:80px;height:80px}.avatar__placeholder{font-size:1.25rem}}
/*$vite$:1*/`,document.head.appendChild(m);class u{constructor(t){var e,a;this.baseUrl=t.baseUrl||"",this.profileForm=t.profileForm,this.firstNameInput=t.firstNameInput,this.lastNameInput=t.lastNameInput,this.displayName=t.displayName,this.displayEmail=t.displayEmail,this.saveBtn=t.saveBtn,this.showToast=t.showToast||this.defaultToast.bind(this),this.isSubmitting=!1,this.userData=t.userData||null,this.originalFirstName=((e=this.firstNameInput)==null?void 0:e.value)||"",this.originalLastName=((a=this.lastNameInput)==null?void 0:a.value)||"",this.authToken=null,this.init()}init(){if(this.authToken=this.getTokenFromCookie(),!this.authToken){this.showToast("Please sign in to view your profile","error"),setTimeout(()=>{window.location.href="/sign-in"},1500);return}this.profileForm&&this.profileForm.addEventListener("submit",t=>this.handleSubmit(t)),this.firstNameInput&&this.firstNameInput.addEventListener("input",()=>this.checkForChanges()),this.lastNameInput&&this.lastNameInput.addEventListener("input",()=>this.checkForChanges()),this.saveBtn&&(this.saveBtn.disabled=!0)}getTokenFromCookie(){const t=document.cookie.split(";");for(const e of t){const[a,r]=e.trim().split("=");if(a==="auth_token")return decodeURIComponent(r)}return null}getAuthToken(){return this.authToken}checkForChanges(){var r,s;if(!this.saveBtn)return;const t=((r=this.firstNameInput)==null?void 0:r.value)||"",e=((s=this.lastNameInput)==null?void 0:s.value)||"",a=t!==this.originalFirstName||e!==this.originalLastName;this.saveBtn.disabled=!a}async handleSubmit(t){var r,s;if(t.preventDefault(),this.isSubmitting)return;const e=((r=this.firstNameInput)==null?void 0:r.value.trim())||"",a=((s=this.lastNameInput)==null?void 0:s.value.trim())||"";if(!e){this.showToast("First name is required","error");return}if(!a){this.showToast("Last name is required","error");return}this.isSubmitting=!0,this.setButtonLoading(!0);try{const i=await fetch(`${this.baseUrl}/api/v1/user`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.authToken}`},body:JSON.stringify({first_name:e,last_name:a})}),n=await i.json();i.ok?(this.originalFirstName=e,this.originalLastName=a,this.userData&&(this.userData.first_name=e,this.userData.last_name=a),this.displayName&&(this.displayName.textContent=`${e} ${a}`),this.showToast("Profile updated successfully!","success"),this.saveBtn.disabled=!0):this.handleApiError(n)}catch(i){console.error("Profile update failed:",i),this.showToast("Network error. Please try again.","error")}finally{this.isSubmitting=!1,this.setButtonLoading(!1)}}updateEmail(t){this.userData&&(this.userData.email=t),this.displayEmail&&(this.displayEmail.textContent=t)}getUserInitials(){var a,r;if(!this.userData)return"?";const t=((a=this.userData.first_name)==null?void 0:a[0])||"",e=((r=this.userData.last_name)==null?void 0:r[0])||"";return(t+e).toUpperCase()||"?"}getUserData(){return this.userData}setButtonLoading(t){this.saveBtn&&(this.saveBtn.disabled=t,this.saveBtn.textContent=t?"Saving...":"Save Changes",t?this.saveBtn.classList.add("btn--loading"):this.saveBtn.classList.remove("btn--loading"))}handleApiError(t){const e=t.message||"An error occurred. Please try again.";if(this.showToast(e,"error"),t.errors)for(const[a,r]of Object.entries(t.errors))Array.isArray(r)&&r.forEach(s=>this.showToast(`${a}: ${s}`,"error"))}defaultToast(t,e="info"){console.log(`[${e.toUpperCase()}] ${t}`),alert(t)}}class p{constructor(t){this.baseUrl=t.baseUrl||"",this.avatarContainer=t.avatarContainer,this.avatarImage=t.avatarImage,this.avatarPlaceholder=t.avatarPlaceholder,this.fileInput=t.fileInput,this.previewModal=t.previewModal,this.previewImage=t.previewImage,this.confirmBtn=t.confirmBtn,this.cancelBtn=t.cancelBtn,this.showToast=t.showToast||this.defaultToast.bind(this),this.getAuthToken=t.getAuthToken||(()=>null),this.onUploadSuccess=t.onUploadSuccess||(()=>{}),this.selectedFile=null,this.isUploading=!1,this.maxFileSize=5*1024*1024,this.allowedTypes=["image/jpeg","image/png","image/gif","image/webp"],this.init()}init(){if(!this.fileInput||!this.avatarContainer){console.error("AvatarUpload: Required elements not found");return}const t=this.avatarContainer.querySelector(".avatar__overlay");t&&t.addEventListener("click",()=>this.fileInput.click()),this.fileInput.addEventListener("change",e=>this.handleFileSelect(e)),this.confirmBtn&&this.confirmBtn.addEventListener("click",()=>this.uploadAvatar()),this.cancelBtn&&this.cancelBtn.addEventListener("click",()=>this.closePreview()),this.previewModal&&this.previewModal.addEventListener("click",e=>{e.target===this.previewModal&&this.closePreview()})}handleFileSelect(t){const e=t.target.files[0];if(e){if(!this.allowedTypes.includes(e.type)){this.showToast("Please select a valid image file (JPEG, PNG, GIF, or WebP)","error"),this.fileInput.value="";return}if(e.size>this.maxFileSize){this.showToast("Image must be smaller than 5MB","error"),this.fileInput.value="";return}this.selectedFile=e,this.showPreview(e)}}showPreview(t){if(!this.previewModal||!this.previewImage)return;const e=new FileReader;e.onload=a=>{this.previewImage.src=a.target.result,this.previewModal.classList.remove("hidden")},e.readAsDataURL(t)}closePreview(){this.previewModal&&this.previewModal.classList.add("hidden"),this.selectedFile=null,this.fileInput.value=""}async uploadAvatar(){if(!this.selectedFile||this.isUploading)return;if(!this.getAuthToken()){this.showToast("Please sign in to upload avatar","error");return}this.isUploading=!0,this.setButtonLoading(!0);const e=new FormData;e.append("file",this.selectedFile);try{const a=await fetch(`${this.baseUrl}/api/v1/upload/avatar`,{method:"POST",body:e}),r=await a.json();if(a.ok&&r.status==="success"){const s=r.upload,i=s.url;this.updateAvatarDisplay(i),this.showToast("Profile picture updated!","success"),this.closePreview(),this.onUploadSuccess(s)}else this.showToast(r.message||"Failed to upload profile picture","error")}catch(a){console.error("Avatar upload failed:",a),this.showToast("Network error. Please try again.","error")}finally{this.isUploading=!1,this.setButtonLoading(!1)}}updateAvatarDisplay(t){this.avatarImage&&(this.avatarImage.src=t,this.avatarImage.classList.remove("hidden")),this.avatarPlaceholder&&this.avatarPlaceholder.classList.add("hidden")}setAvatar(t){t?this.updateAvatarDisplay(t):(this.avatarImage&&this.avatarImage.classList.add("hidden"),this.avatarPlaceholder&&this.avatarPlaceholder.classList.remove("hidden"))}setButtonLoading(t){this.confirmBtn&&(this.confirmBtn.disabled=t,this.confirmBtn.textContent=t?"Uploading...":"Save",t?this.confirmBtn.classList.add("btn--loading"):this.confirmBtn.classList.remove("btn--loading"))}defaultToast(t,e="info"){console.log(`[${e.toUpperCase()}] ${t}`),alert(t)}}class f{constructor(t){this.baseUrl=t.baseUrl||"",this.form=t.form,this.currentPasswordInput=t.currentPasswordInput,this.newPasswordInput=t.newPasswordInput,this.confirmPasswordInput=t.confirmPasswordInput,this.strengthBar=t.strengthBar,this.strengthText=t.strengthText,this.submitBtn=t.submitBtn,this.showToast=t.showToast||this.defaultToast.bind(this),this.getAuthToken=t.getAuthToken||(()=>null),this.isSubmitting=!1,this.init()}init(){if(!this.form){console.error("PasswordChange: Form element not found");return}this.form.addEventListener("submit",t=>this.handleSubmit(t)),this.newPasswordInput&&this.newPasswordInput.addEventListener("input",t=>{this.updatePasswordStrength(t.target.value)})}async handleSubmit(t){var i,n,l;if(t.preventDefault(),this.isSubmitting)return;const e=((i=this.currentPasswordInput)==null?void 0:i.value)||"",a=((n=this.newPasswordInput)==null?void 0:n.value)||"",r=((l=this.confirmPasswordInput)==null?void 0:l.value)||"";if(!this.validatePasswords(e,a,r))return;const s=this.getAuthToken();if(!s){this.showToast("Please sign in to change password","error");return}this.isSubmitting=!0,this.setButtonLoading(!0);try{const d=await fetch(`${this.baseUrl}/api/v1/password/change-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({current_password:e,new_password:a,confirm_password:r})}),v=await d.json();d.ok?(this.showToast("Password changed successfully! Redirecting to sign in...","success"),this.form.reset(),this.updatePasswordStrength(""),this.clearAuthCookie(),setTimeout(()=>{window.location.href="/sign-in"},1500)):this.handleApiError(v)}catch(d){console.error("Password change failed:",d),this.showToast("Network error. Please try again.","error")}finally{this.isSubmitting=!1,this.setButtonLoading(!1)}}validatePasswords(t,e,a){return t?e?e.length<8?(this.showToast("Password must be at least 8 characters","error"),!1):/[A-Z]/.test(e)?/[a-z]/.test(e)?/[0-9]/.test(e)?/[^\p{L}\p{N}]/u.test(e)?e!==a?(this.showToast("Passwords do not match","error"),!1):t===e?(this.showToast("New password must be different from current password","error"),!1):!0:(this.showToast("Password must contain at least one special character","error"),!1):(this.showToast("Password must contain at least one digit","error"),!1):(this.showToast("Password must contain at least one lowercase letter","error"),!1):(this.showToast("Password must contain at least one uppercase letter","error"),!1):(this.showToast("New password is required","error"),!1):(this.showToast("Current password is required","error"),!1)}updatePasswordStrength(t){if(!this.strengthBar||!this.strengthText)return;const e=this.calculatePasswordStrength(t);if(this.strengthBar.classList.remove("password-strength__bar--weak","password-strength__bar--fair","password-strength__bar--good","password-strength__bar--strong"),t.length===0){this.strengthBar.style.width="0",this.strengthText.textContent="";return}e<2?(this.strengthBar.classList.add("password-strength__bar--weak"),this.strengthText.textContent="Weak"):e<3?(this.strengthBar.classList.add("password-strength__bar--fair"),this.strengthText.textContent="Fair"):e<4?(this.strengthBar.classList.add("password-strength__bar--good"),this.strengthText.textContent="Good"):(this.strengthBar.classList.add("password-strength__bar--strong"),this.strengthText.textContent="Strong")}calculatePasswordStrength(t){let e=0;return t.length>=8&&e++,t.length>=12&&e++,/[A-Z]/.test(t)&&e++,/[a-z]/.test(t)&&e++,/[0-9]/.test(t)&&e++,/[!@#$%^&*(),.?":{}|<>]/.test(t)&&e++,Math.min(e,5)}setButtonLoading(t){this.submitBtn&&(this.submitBtn.disabled=t,this.submitBtn.textContent=t?"Changing...":"Change Password",t?this.submitBtn.classList.add("btn--loading"):this.submitBtn.classList.remove("btn--loading"))}handleApiError(t){const e=t.message||"An error occurred. Please try again.";if(this.showToast(e,"error"),t.errors)for(const[a,r]of Object.entries(t.errors))Array.isArray(r)&&r.forEach(s=>this.showToast(`${a}: ${s}`,"error"))}clearAuthCookie(){document.cookie="auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}defaultToast(t,e="info"){console.log(`[${e.toUpperCase()}] ${t}`),alert(t)}}class g{constructor(t){this.baseUrl=t.baseUrl||"",this.step1Card=t.step1Card,this.step2Card=t.step2Card,this.step3Card=t.step3Card,this.emailForm=t.emailForm,this.verifyForm=t.verifyForm,this.newEmailInput=t.newEmailInput,this.codeInput=t.codeInput,this.emailBtn=t.emailBtn,this.verifyBtn=t.verifyBtn,this.stepIndicators=t.stepIndicators||[],this.showToast=t.showToast||this.defaultToast.bind(this),this.getAuthToken=t.getAuthToken||(()=>null),this.onEmailChanged=t.onEmailChanged||(()=>{}),this.currentStep=1,this.isSubmitting=!1,this.newEmail="",this.verificationCode="",this.init()}init(){var e;this.emailForm&&this.emailForm.addEventListener("submit",a=>this.handleEmailSubmit(a)),this.verifyForm&&this.verifyForm.addEventListener("submit",a=>this.handleVerifySubmit(a)),this.codeInput&&this.codeInput.addEventListener("input",a=>this.formatCodeInput(a));const t=(e=this.step3Card)==null?void 0:e.querySelector('[data-action="start-over"]');t&&t.addEventListener("click",()=>this.goToStep(1))}async handleEmailSubmit(t){var r,s;if(t.preventDefault(),this.isSubmitting)return;const e=((r=this.newEmailInput)==null?void 0:r.value.trim())||"";if(!this.validateEmail(e))return;const a=this.getAuthToken();if(!a){this.showToast("Please sign in to change email","error");return}this.isSubmitting=!0,this.setButtonLoading(this.emailBtn,!0,"Checking...");try{const i=await fetch(`${this.baseUrl}/api/v1/email/check-availability`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({email:e})}),n=await i.json();if(!i.ok){(s=n.message)!=null&&s.toLowerCase().includes("already")?this.showToast("This email is already in use","error"):this.showToast(n.message||"Could not verify email availability","error"),this.setButtonLoading(this.emailBtn,!1,"Send Verification Code"),this.isSubmitting=!1;return}const l=await fetch(`${this.baseUrl}/api/v1/email/request-change`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({new_email:e})}),d=await l.json();l.ok?(this.newEmail=e,this.showToast("Verification code sent to your new email!","success"),this.goToStep(2)):(this.showToast(d.message||"Failed to send verification code","error"),this.setButtonLoading(this.emailBtn,!1,"Send Verification Code"))}catch(i){console.error("Email check failed:",i),this.showToast("Network error. Please try again.","error"),this.setButtonLoading(this.emailBtn,!1,"Send Verification Code")}finally{this.isSubmitting=!1}}async handleVerifySubmit(t){var r;if(t.preventDefault(),this.isSubmitting)return;const e=((r=this.codeInput)==null?void 0:r.value.trim())||"";if(!e||e.length<20){this.showToast("Please enter the 20 character verification code","error");return}const a=this.getAuthToken();if(!a){this.showToast("Please sign in to change email","error");return}this.isSubmitting=!0,this.setButtonLoading(this.verifyBtn,!0,"Verifying...");try{const s=await fetch(`${this.baseUrl}/api/v1/email/verify-change`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({code:e,new_email:this.newEmail})}),i=await s.json();s.ok?(this.showToast("Email changed successfully!","success"),this.goToStep(3),this.onEmailChanged(this.newEmail)):(this.showToast(i.message||"Invalid verification code","error"),this.setButtonLoading(this.verifyBtn,!1,"Verify & Change Email"))}catch(s){console.error("Email verification failed:",s),this.showToast("Network error. Please try again.","error"),this.setButtonLoading(this.verifyBtn,!1,"Verify & Change Email")}finally{this.isSubmitting=!1}}goToStep(t){var a,r,s,i,n;this.currentStep=t,(a=this.step1Card)==null||a.classList.add("hidden"),(r=this.step2Card)==null||r.classList.add("hidden"),(s=this.step3Card)==null||s.classList.add("hidden");const e=this.getCardForStep(t);if(e){e.classList.remove("hidden");const l=e.querySelector('input:not([type="hidden"])');l&&setTimeout(()=>l.focus(),100)}this.updateStepIndicators(t),this.setButtonLoading(this.emailBtn,!1,"Send Verification Code"),this.setButtonLoading(this.verifyBtn,!1,"Verify & Change Email"),t===1&&((i=this.emailForm)==null||i.reset(),(n=this.verifyForm)==null||n.reset(),this.newEmail="",this.verificationCode="")}getCardForStep(t){switch(t){case 1:return this.step1Card;case 2:return this.step2Card;case 3:return this.step3Card;default:return null}}updateStepIndicators(t){this.stepIndicators.forEach((e,a)=>{const r=a+1;e.classList.remove("email-step--active","email-step--completed"),r<t?e.classList.add("email-step--completed"):r===t&&e.classList.add("email-step--active")})}validateEmail(t){return t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?!0:(this.showToast("Please enter a valid email address","error"),!1):(this.showToast("Email is required","error"),!1)}formatCodeInput(t){const e=t.target;e.value=e.value.replace(/[^a-zA-Z0-9]/g,"").slice(0,20)}setButtonLoading(t,e,a){t&&(t.disabled=e,t.textContent=a,e?t.classList.add("btn--loading"):t.classList.remove("btn--loading"))}defaultToast(t,e="info"){console.log(`[${e.toUpperCase()}] ${t}`),alert(t)}}function h(o,t="info"){const e={success:"linear-gradient(135deg, #10b981 0%, #059669 100%)",error:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",warning:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",info:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"};typeof Toastify=="function"?Toastify({text:o,duration:4e3,gravity:"top",position:"right",stopOnFocus:!0,style:{background:e[t]||e.info,borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}}).showToast():console.log(`[${t.toUpperCase()}] ${o}`)}function c(){const o=window.BASE_URL||"",t=window.USER_DATA||null,e=new u({baseUrl:o,userData:t,profileForm:document.getElementById("profileForm"),firstNameInput:document.getElementById("first_name"),lastNameInput:document.getElementById("last_name"),displayName:document.getElementById("displayName"),displayEmail:document.getElementById("displayEmail"),saveBtn:document.getElementById("saveProfileBtn"),showToast:h}),a=new p({baseUrl:o,avatarContainer:document.getElementById("avatarContainer"),avatarImage:document.getElementById("avatarImage"),avatarPlaceholder:document.getElementById("avatarPlaceholder"),fileInput:document.getElementById("avatarInput"),previewModal:document.getElementById("avatarPreviewModal"),previewImage:document.getElementById("previewImage"),confirmBtn:document.getElementById("confirmAvatarBtn"),cancelBtn:document.getElementById("cancelAvatarBtn"),showToast:h,getAuthToken:()=>e.getAuthToken(),onUploadSuccess:i=>{console.log("Avatar uploaded:",i)}}),r=new f({baseUrl:o,form:document.getElementById("passwordForm"),currentPasswordInput:document.getElementById("current_password"),newPasswordInput:document.getElementById("new_password"),confirmPasswordInput:document.getElementById("confirm_password"),strengthBar:document.querySelector(".password-strength__bar"),strengthText:document.querySelector(".password-strength-text"),submitBtn:document.getElementById("changePasswordBtn"),showToast:h,getAuthToken:()=>e.getAuthToken()}),s=new g({baseUrl:o,step1Card:document.getElementById("emailStep1"),step2Card:document.getElementById("emailStep2"),step3Card:document.getElementById("emailStep3"),emailForm:document.getElementById("newEmailForm"),verifyForm:document.getElementById("verifyEmailForm"),newEmailInput:document.getElementById("new_email"),codeInput:document.getElementById("email_code"),emailBtn:document.getElementById("sendEmailCodeBtn"),verifyBtn:document.getElementById("verifyEmailBtn"),stepIndicators:Array.from(document.querySelectorAll(".email-step")),showToast:h,getAuthToken:()=>e.getAuthToken(),onEmailChanged:i=>{e.updateEmail(i)}});t&&t.avatar_url&&a.setAvatar(t.avatar_url),window.profilePage=e,window.avatarUpload=a,window.passwordChange=r,window.emailChange=s}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c()})();
