(function(){"use strict";var c=document.createElement("style");c.textContent=`.forgot-password-page{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:var(--gradient-primary);min-height:100vh;color:var(--color-text-primary);transition:background .25s ease}.container{max-width:1200px;margin:0 auto;padding:2rem;display:flex;align-items:center;justify-content:center;min-height:calc(100vh - 80px)}.card{background:var(--color-surface);border-radius:6px;padding:2rem;box-shadow:var(--shadow-lg);max-width:400px;width:100%;transition:background-color .25s ease,box-shadow .25s ease,opacity .25s ease,transform .25s ease}.card h1{text-align:center;color:var(--color-text-primary);margin-bottom:1.5rem;font-size:1.5rem;font-weight:600;transition:color .25s ease}.card.hidden{display:none}.card--entering{animation:cardFadeIn .25s ease forwards}.card--exiting{animation:cardFadeOut .15s ease forwards}@keyframes cardFadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes cardFadeOut{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-10px)}}.step-indicator{display:flex;justify-content:center;gap:.5rem;margin-bottom:1.5rem}.step-indicator__dot{width:10px;height:10px;border-radius:50%;background:var(--color-border);transition:background .25s ease,transform .25s ease}.step-indicator__dot--active{background:var(--color-primary);transform:scale(1.2)}.step-indicator__dot--completed{background:var(--color-success)}.form-group{margin-bottom:1rem}.form-group label{display:block;margin-bottom:.5rem;font-weight:500;color:var(--gray-700);transition:color .25s ease}.form-group input{width:100%;padding:.75rem 1rem;border:2px solid var(--input-border);border-radius:4px;font-size:1rem;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:var(--input-bg);color:var(--color-text-primary);transition:border-color .25s ease,background-color .25s ease,color .25s ease}.form-group input:focus{outline:none;border-color:var(--color-border-focus);box-shadow:var(--focus-ring)}.form-group input::placeholder{color:var(--input-placeholder)}.form-group input.input--error{border-color:var(--color-border-error)}.form-group input.input--success{border-color:var(--color-border-success)}.form-group--code input{text-align:center;font-size:1.25rem;letter-spacing:.5em;font-weight:600}.password-strength{margin-top:.5rem;height:4px;border-radius:4px;background:var(--color-border);overflow:hidden}.password-strength__bar{height:100%;transition:width .25s ease,background .25s ease;border-radius:4px}.password-strength__bar--weak{width:25%;background:var(--color-error)}.password-strength__bar--fair{width:50%;background:var(--color-warning)}.password-strength__bar--good{width:75%;background:var(--color-info)}.password-strength__bar--strong{width:100%;background:var(--color-success)}.password-strength-text{font-size:.875rem;margin-top:.25rem;color:var(--color-text-muted)}.btn{width:100%;padding:.75rem 1rem;background:var(--gradient-primary);color:var(--color-text-on-primary);border:none;border-radius:4px;font-size:1rem;font-weight:600;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease;margin-top:.5rem}.btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:var(--shadow-primary-glow)}.btn:active:not(:disabled){transform:translateY(0)}.btn:focus{outline:none;box-shadow:var(--focus-ring)}.btn:disabled{opacity:var(--btn-disabled-opacity);cursor:not-allowed;transform:none}.btn--loading{position:relative;color:transparent}.btn--loading:after{content:"";position:absolute;width:20px;height:20px;top:50%;left:50%;margin-left:-10px;margin-top:-10px;border:2px solid transparent;border-top-color:var(--color-text-on-primary);border-radius:50%;animation:spin .8s linear infinite}.btn--secondary{background:transparent;color:var(--color-primary);border:2px solid var(--color-primary)}.btn--secondary:hover:not(:disabled){background:var(--color-primary);color:var(--color-text-on-primary)}@keyframes spin{to{transform:rotate(360deg)}}.link{color:var(--color-primary);text-decoration:none;font-weight:500;transition:color .15s ease}.link:hover{text-decoration:underline;color:var(--color-primary-dark)}.link:focus{outline:none;box-shadow:var(--focus-ring);border-radius:4px}.text-center{text-align:center}.text-muted{color:var(--color-text-muted)}.mt-1{margin-top:1rem}.info-text{color:var(--color-text-secondary);text-align:center;margin-bottom:1.5rem;line-height:1.6}.resend-link{display:block;text-align:center;margin-top:1rem;font-size:.875rem;color:var(--color-text-muted)}.resend-link button{background:none;border:none;color:var(--color-primary);font-weight:500;cursor:pointer;font-size:inherit;font-family:inherit;padding:0;transition:color .15s ease}.resend-link button:hover{text-decoration:underline;color:var(--color-primary-dark)}.resend-link button:disabled{color:var(--color-text-muted);cursor:not-allowed}.success-message{text-align:center;padding:1.5rem}.success-message__icon{width:64px;height:64px;margin:0 auto 1rem;background:var(--gradient-success);border-radius:50%;display:flex;align-items:center;justify-content:center;animation:scaleIn .25s ease forwards}.success-message__icon svg{width:32px;height:32px;color:#fff}.success-message__title{font-size:1.25rem;font-weight:600;margin-bottom:.5rem;color:var(--color-text-primary)}.success-message__text{color:var(--color-text-secondary);margin-bottom:1.5rem}@keyframes scaleIn{0%{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}@media (max-width: 768px){.container{padding:1rem}.card{padding:1.5rem}.card h1{font-size:1.25rem}}@media (max-width: 480px){.card{padding:1rem;margin:.5rem}.card h1{font-size:1.125rem}.btn{padding:1rem}.form-group--code input{font-size:1.125rem;letter-spacing:.3em}}*,*:before,*:after{margin:0;padding:0;box-sizing:border-box}html{font-size:16px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color-scheme:light dark}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;line-height:1.5;color:var(--color-text-primary);background-color:var(--color-bg-primary);transition:background-color .25s ease,color .25s ease}@media (prefers-reduced-motion: reduce){*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}
/*$vite$:1*/`,document.head.appendChild(c);class u{constructor(e){this.baseUrl=e.baseUrl||"",this.requestCard=e.requestCard,this.verifyCard=e.verifyCard,this.resetCard=e.resetCard,this.requestForm=e.requestForm,this.verifyForm=e.verifyForm,this.resetForm=e.resetForm,this.requestBtn=e.requestBtn,this.verifyBtn=e.verifyBtn,this.resetBtn=e.resetBtn,this.showToast=e.showToast||this.defaultToast.bind(this),this.currentStep=1,this.isSubmitting=!1,this.userEmail="",this.verifiedCode="",this.init()}init(){if(!this.requestForm||!this.verifyForm||!this.resetForm){console.error("ForgotPassword: Required form elements not found");return}this.requestForm.addEventListener("submit",r=>this.handleRequestCode(r)),this.verifyForm.addEventListener("submit",r=>this.handleVerifyCode(r)),this.resetForm.addEventListener("submit",r=>this.handleResetPassword(r));const e=document.getElementById("reset_code");e&&e.addEventListener("input",r=>this.formatCodeInput(r));const t=document.getElementById("new_password");t&&t.addEventListener("input",r=>this.updatePasswordStrength(r.target.value))}async handleRequestCode(e){var o;if(e.preventDefault(),this.isSubmitting)return;const t=((o=this.requestForm.querySelector("#email"))==null?void 0:o.value.trim())||"";if(!this.validateEmail(t))return;this.setButtonLoading(this.requestBtn,!0,"Sending..."),this.isSubmitting=!0;const r=await this.apiRequest("/api/v1/account/forgot-password","POST",{email:t});if(this.isSubmitting=!1,r.ok){this.userEmail=t,this.showToast("Reset code sent! Please check your email.","success");const s=document.getElementById("verify_email"),a=document.getElementById("reset_email");s&&(s.value=t),a&&(a.value=t),this.goToStep(2)}else this.setButtonLoading(this.requestBtn,!1,"Send Reset Code"),this.handleApiError(r)}async handleVerifyCode(e){var s,a;if(e.preventDefault(),this.isSubmitting)return;const t=((s=this.verifyForm.querySelector("#reset_code"))==null?void 0:s.value.trim())||"",r=this.userEmail||((a=document.getElementById("verify_email"))==null?void 0:a.value)||"";if(!t||t.length<20){this.showToast("Please enter the 20 character code","error");return}this.setButtonLoading(this.verifyBtn,!0,"Verifying..."),this.isSubmitting=!0;const o=await this.apiRequest("/api/v1/account/verify-hash","POST",{email:r,code:t});this.isSubmitting=!1,o.ok?(this.showToast("Code verified! Please enter your new password.","success"),this.verifiedCode=t,this.goToStep(3)):(this.setButtonLoading(this.verifyBtn,!1,"Verify Code"),this.handleApiError(o))}async handleResetPassword(e){var a,i,d;if(e.preventDefault(),this.isSubmitting)return;const t=((a=this.resetForm.querySelector("#new_password"))==null?void 0:a.value)||"",r=((i=this.resetForm.querySelector("#confirm_password"))==null?void 0:i.value)||"";this.userEmail||(d=document.getElementById("reset_email"))!=null&&d.value;const o=this.verifiedCode;if(!o){this.showToast("Verification code is missing. Please start over.","error"),this.goToStep(1);return}if(!this.validatePasswords(t,r))return;this.setButtonLoading(this.resetBtn,!0,"Resetting..."),this.isSubmitting=!0;const s=await this.apiRequest("/api/v1/account/reset-password","POST",{code:o,password:t,confirm_password:r});this.isSubmitting=!1,s.ok?(this.showToast("Password reset successful! Redirecting to sign in...","success"),this.setButtonLoading(this.resetBtn,!1,"Redirecting..."),setTimeout(()=>{window.location.href="/sign-in"},2e3)):(this.setButtonLoading(this.resetBtn,!1,"Reset Password"),this.handleApiError(s))}goToStep(e){var r,o,s;this.currentStep=e,(r=this.requestCard)==null||r.classList.add("hidden"),(o=this.verifyCard)==null||o.classList.add("hidden"),(s=this.resetCard)==null||s.classList.add("hidden");const t=this.getCardForStep(e);if(t){t.classList.remove("hidden");const a=t.querySelector('input:not([type="hidden"])');a&&setTimeout(()=>a.focus(),100)}this.setButtonLoading(this.requestBtn,!1,"Send Reset Code"),this.setButtonLoading(this.verifyBtn,!1,"Verify Code"),this.setButtonLoading(this.resetBtn,!1,"Reset Password")}getCardForStep(e){switch(e){case 1:return this.requestCard;case 2:return this.verifyCard;case 3:return this.resetCard;default:return null}}validateEmail(e){return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?!0:(this.showToast("Please enter a valid email address","error"),!1):(this.showToast("Email is required","error"),!1)}validatePasswords(e,t){return e?e.length<8?(this.showToast("Password must be at least 8 characters","error"),!1):/[A-Z]/.test(e)?/[a-z]/.test(e)?/[0-9]/.test(e)?/[^\p{L}\p{N}]/u.test(e)?e!==t?(this.showToast("Passwords do not match","error"),!1):!0:(this.showToast("Password must contain at least one special character","error"),!1):(this.showToast("Password must contain at least one digit","error"),!1):(this.showToast("Password must contain at least one lowercase letter","error"),!1):(this.showToast("Password must contain at least one uppercase letter","error"),!1):(this.showToast("Password is required","error"),!1)}formatCodeInput(e){const t=e.target;t.value=t.value.replace(/[^a-zA-Z0-9]/g,"").slice(0,20)}updatePasswordStrength(e){const t=document.querySelector(".password-strength__bar"),r=document.querySelector(".password-strength-text");if(!t||!r)return;const o=this.calculatePasswordStrength(e);if(t.classList.remove("password-strength__bar--weak","password-strength__bar--fair","password-strength__bar--good","password-strength__bar--strong"),e.length===0){t.style.width="0",r.textContent="";return}o<2?(t.classList.add("password-strength__bar--weak"),r.textContent="Weak"):o<3?(t.classList.add("password-strength__bar--fair"),r.textContent="Fair"):o<4?(t.classList.add("password-strength__bar--good"),r.textContent="Good"):(t.classList.add("password-strength__bar--strong"),r.textContent="Strong")}calculatePasswordStrength(e){let t=0;return e.length>=8&&t++,e.length>=12&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[!@#$%^&*(),.?":{}|<>]/.test(e)&&t++,Math.min(t,5)}setButtonLoading(e,t,r){e&&(e.disabled=t,e.textContent=r,t?e.classList.add("btn--loading"):e.classList.remove("btn--loading"))}handleApiError(e){var r,o;const t=((r=e.data)==null?void 0:r.message)||"An error occurred. Please try again.";if(this.showToast(t,"error"),(o=e.data)!=null&&o.errors)for(const[s,a]of Object.entries(e.data.errors))Array.isArray(a)&&a.forEach(i=>this.showToast(`${s}: ${i}`,"error"))}async apiRequest(e,t="GET",r=null){const o={method:t,headers:{"Content-Type":"application/json"}};r&&(o.body=JSON.stringify(r));try{const s=await fetch(`${this.baseUrl}${e}`,o),a=await s.json();return{ok:s.ok,data:a}}catch(s){return console.error("API request failed:",s),{ok:!1,data:{message:"Network error. Please try again."}}}}defaultToast(e,t="info"){console.log(`[${t.toUpperCase()}] ${e}`),alert(e)}}function l(){const n=document.getElementById("requestCard"),e=document.getElementById("verifyCard"),t=document.getElementById("resetCard"),r=document.getElementById("requestForm"),o=document.getElementById("verifyForm"),s=document.getElementById("resetForm"),a=document.getElementById("requestBtn"),i=document.getElementById("verifyBtn"),d=document.getElementById("resetBtn");if(!n||!e||!t){console.error("ForgotPassword page: Required card elements not found");return}if(!r||!o||!s){console.error("ForgotPassword page: Required form elements not found");return}const h=window.BASE_URL||"",f=m(),g=new u({baseUrl:h,requestCard:n,verifyCard:e,resetCard:t,requestForm:r,verifyForm:o,resetForm:s,requestBtn:a,verifyBtn:i,resetBtn:d,showToast:f});typeof window<"u"&&(window.forgotPasswordController=g)}function m(){const n={success:"linear-gradient(to right, #00b09b, #96c93d)",error:"linear-gradient(to right, #ff5f6d, #ffc371)",info:"linear-gradient(to right, #667eea, #764ba2)"};return function(t,r="success"){typeof Toastify<"u"?Toastify({text:t,duration:4e3,gravity:"top",position:"right",style:{background:n[r]||n.info}}).showToast():console.log(`[${r.toUpperCase()}] ${t}`)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",l):l()})();
