(function(){"use strict";class v{constructor(){this.COOKIE_NAME="blazing_sun_theme",this.DARK_THEME="dark",this.LIGHT_THEME="light",this.COOKIE_MAX_AGE=365*24*60*60,this.toggleButton=document.getElementById("themeToggle"),this.init()}init(){const e=this.getStoredTheme();e?this.applyTheme(e):this.applyTheme(this.getSystemTheme()),this.toggleButton&&this.toggleButton.addEventListener("click",()=>this.toggle())}getTheme(){return this.getStoredTheme()||this.LIGHT_THEME}getStoredTheme(){const e=document.cookie.split("; ").find(a=>a.startsWith(this.COOKIE_NAME+"="));if(!e)return null;const t=e.split("=")[1];return t===this.DARK_THEME||t===this.LIGHT_THEME?t:null}getSystemTheme(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.DARK_THEME:this.LIGHT_THEME}saveToCookie(e){document.cookie=`${this.COOKIE_NAME}=${e}; path=/; max-age=${this.COOKIE_MAX_AGE}; SameSite=Lax`}applyTheme(e){e===this.DARK_THEME?document.documentElement.setAttribute("data-theme",this.DARK_THEME):document.documentElement.removeAttribute("data-theme"),this.saveToCookie(e)}toggle(){const t=this.getTheme()===this.DARK_THEME?this.LIGHT_THEME:this.DARK_THEME;this.applyTheme(t)}setTheme(e){(e===this.DARK_THEME||e===this.LIGHT_THEME)&&this.applyTheme(e)}isDark(){return this.getTheme()===this.DARK_THEME}}class L{constructor(){this.navbar=document.querySelector(".navbar"),this.links=document.querySelectorAll(".navbar__link"),this.init()}init(){this.highlightActiveLink(),this.setupScrollBehavior()}highlightActiveLink(){const e=window.location.pathname;this.links.forEach(t=>{new URL(t.href).pathname===e?t.classList.add("navbar__link--active"):t.classList.remove("navbar__link--active")})}setupScrollBehavior(){this.navbar&&window.addEventListener("scroll",()=>{window.pageYOffset>10?this.navbar.classList.add("navbar--scrolled"):this.navbar.classList.remove("navbar--scrolled")},{passive:!0})}}function u(){const o=document.querySelector('meta[name="csrf-token"]');return o?o.getAttribute("content"):(console.warn('CSRF token not found. Ensure <meta name="csrf-token"> exists in page head.'),null)}function h(o={}){const e=u(),t={"Content-Type":"application/json",...o};return e&&(t["X-CSRF-TOKEN"]=e),t}class g{constructor(e={}){this.options={showIcons:!0,validateOnInput:!0,...e},this.validationRules={email:[{test:t=>t.length>0,message:"Email is required",key:"required"},{test:t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),message:"Must be a valid email format",key:"format"}],password:[{test:t=>t.length>0,message:"Password is required",key:"required"},{test:t=>t.length>=8,message:"Minimum 8 characters",key:"minLength"},{test:t=>/[A-Z]/.test(t),message:"At least one uppercase letter",key:"uppercase"},{test:t=>/[a-z]/.test(t),message:"At least one lowercase letter",key:"lowercase"},{test:t=>/[0-9]/.test(t),message:"At least one number",key:"number"},{test:t=>/[!@#$%^&*(),.?":{}|<>_\-+=\[\]\\\/`~]/.test(t),message:"At least one special character",key:"special"}],first_name:[{test:t=>t.length>0,message:"First name is required",key:"required"},{test:t=>t.length>=2,message:"Minimum 2 characters",key:"minLength"},{test:t=>/^[a-zA-Z\s'-]+$/.test(t)||t.length===0,message:"Letters only (no special characters)",key:"letters"}],last_name:[{test:t=>t.length>0,message:"Last name is required",key:"required"},{test:t=>t.length>=2,message:"Minimum 2 characters",key:"minLength"},{test:t=>/^[a-zA-Z\s'-]+$/.test(t)||t.length===0,message:"Letters only (no special characters)",key:"letters"}],current_password:[{test:t=>t.length>0,message:"Current password is required",key:"required"}],new_password:[{test:t=>t.length>0,message:"New password is required",key:"required"},{test:t=>t.length>=8,message:"Minimum 8 characters",key:"minLength"},{test:t=>/[A-Z]/.test(t),message:"At least one uppercase letter",key:"uppercase"},{test:t=>/[a-z]/.test(t),message:"At least one lowercase letter",key:"lowercase"},{test:t=>/[0-9]/.test(t),message:"At least one number",key:"number"},{test:t=>/[!@#$%^&*(),.?":{}|<>_\-+=\[\]\\\/`~]/.test(t),message:"At least one special character",key:"special"}]},this.boundInputs=new Map,this.passwordConfirmPairs=new Map}bindPasswordConfirm(e,t,a){if(!e||!t)return;const s={input:e,type:"password_confirm",feedbackContainer:a,isValid:!1,touched:!1,passwordInput:t};if(this.boundInputs.set(e,s),this.passwordConfirmPairs.set(e,t),a){a.innerHTML="",a.className="validation-feedback";const n=document.createElement("div");n.className="validation-item",n.dataset.rule="match",n.innerHTML=`
                <span class="validation-icon"></span>
                <span class="validation-text">Passwords must match</span>
            `,a.appendChild(n)}this.options.validateOnInput&&(e.addEventListener("input",()=>this.validatePasswordConfirm(s)),e.addEventListener("blur",()=>{s.touched=!0,this.validatePasswordConfirm(s)}),t.addEventListener("input",()=>{e.value.length>0&&this.validatePasswordConfirm(s)}))}validatePasswordConfirm(e){const{input:t,feedbackContainer:a,touched:s,passwordInput:n}=e,i=t.value,r=n.value,l=i.length>0&&i===r;if(e.isValid=l,a){const d=a.querySelector('[data-rule="match"]');d&&(d.classList.remove("valid","invalid"),(i.length>0||s)&&d.classList.add(l?"valid":"invalid"))}return t.classList.remove("input--valid","input--invalid"),(i.length>0||s)&&t.classList.add(l?"input--valid":"input--invalid"),l}bindInput(e,t,a){if(!e||!this.validationRules[t])return;const s={input:e,type:t,feedbackContainer:a,isValid:!1,touched:!1};this.boundInputs.set(e,s),this.createFeedbackElements(s),this.options.validateOnInput&&(e.addEventListener("input",()=>this.validateInput(s)),e.addEventListener("blur",()=>{s.touched=!0,this.validateInput(s)})),this.validateInput(s,!1)}createFeedbackElements(e){const{feedbackContainer:t,type:a}=e;if(!t)return;t.innerHTML="",t.className="validation-feedback",this.validationRules[a].forEach(n=>{const i=document.createElement("div");i.className="validation-item",i.dataset.rule=n.key,i.innerHTML=`
                <span class="validation-icon"></span>
                <span class="validation-text">${n.message}</span>
            `,t.appendChild(i)})}validateInput(e,t=!0){const{input:a,type:s,feedbackContainer:n,touched:i}=e,r=a.value,l=this.validationRules[s];let d=!0;return l.forEach(p=>{const w=p.test(r);if(w||(d=!1),n&&(t||i)){const c=n.querySelector(`[data-rule="${p.key}"]`);c&&(c.classList.remove("valid","invalid"),(r.length>0||i)&&c.classList.add(w?"valid":"invalid"))}}),e.isValid=d,a.classList.remove("input--valid","input--invalid"),(r.length>0||i)&&t&&a.classList.add(d?"input--valid":"input--invalid"),d}validateAll(){let e=!0;return this.boundInputs.forEach(t=>{t.touched=!0,t.type==="password_confirm"?this.validatePasswordConfirm(t)||(e=!1):this.validateInput(t,!0)||(e=!1)}),e}isValid(){let e=!0;return this.boundInputs.forEach(t=>{t.isValid||(e=!1)}),e}reset(){this.boundInputs.forEach(e=>{e.touched=!1,e.isValid=!1,e.input.classList.remove("input--valid","input--invalid"),e.feedbackContainer&&e.feedbackContainer.querySelectorAll(".validation-item").forEach(a=>a.classList.remove("valid","invalid"))})}getErrors(){const e={};return this.boundInputs.forEach((t,a)=>{const s=a.value,n=this.validationRules[t.type],i=[];n.forEach(r=>{r.test(s)||i.push(r.message)}),i.length>0&&(e[a.name||a.id||t.type]=i)}),e}}class m{constructor(e,t){this.input=e,this.toggleBtn=t,this.isVisible=!1,this.input&&this.toggleBtn&&this.init()}init(){this.toggleBtn.addEventListener("click",e=>{e.preventDefault(),this.toggle()}),this.updateIcon()}toggle(){this.isVisible=!this.isVisible,this.input.type=this.isVisible?"text":"password",this.updateIcon()}updateIcon(){const e='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>',t='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>';this.toggleBtn.innerHTML=this.isVisible?t:e,this.toggleBtn.setAttribute("aria-label",this.isVisible?"Hide password":"Show password")}}class E{constructor(e={}){this.options={baseUrl:"",onSuccess:null,onError:null,showToast:null,redirectAfterLogin:!1,redirectUrl:"/",...e},this.modal=null,this.form=null,this.validator=null,this.passwordToggle=null,this.isSubmitting=!1,this.createModal(),this.init()}createModal(){if(document.getElementById("loginModal")){this.modal=document.getElementById("loginModal");return}document.body.insertAdjacentHTML("beforeend",`
            <div id="loginModal" class="login-modal" role="dialog" aria-modal="true" aria-labelledby="loginModalTitle">
                <div class="login-modal__backdrop" data-action="close"></div>
                <div class="login-modal__content">
                    <button type="button" class="login-modal__close" data-action="close" aria-label="Close login modal">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>

                    <header class="login-modal__header">
                        <h2 id="loginModalTitle" class="login-modal__title">Sign In</h2>
                        <p class="login-modal__subtitle">Enter your credentials to continue</p>
                    </header>

                    <form id="loginModalForm" class="login-modal__form" novalidate>
                        <!-- Email Field -->
                        <div class="form-group">
                            <label for="loginEmail">Email</label>
                            <div class="input-wrapper">
                                <input
                                    type="email"
                                    id="loginEmail"
                                    name="email"
                                    autocomplete="email"
                                    aria-required="true"
                                    aria-describedby="loginEmailFeedback"
                                    placeholder="you@example.com"
                                >
                            </div>
                            <div id="loginEmailFeedback" class="validation-feedback" aria-live="polite"></div>
                        </div>

                        <!-- Password Field -->
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <div class="input-wrapper input-wrapper--password">
                                <input
                                    type="password"
                                    id="loginPassword"
                                    name="password"
                                    autocomplete="current-password"
                                    aria-required="true"
                                    aria-describedby="loginPasswordFeedback"
                                    placeholder="Enter your password"
                                >
                                <button type="button" class="password-toggle" id="loginPasswordToggle" aria-label="Show password">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                </button>
                            </div>
                            <div id="loginPasswordFeedback" class="validation-feedback" aria-live="polite"></div>
                        </div>

                        <!-- Remember Me -->
                        <div class="form-group form-group--checkbox">
                            <label class="checkbox-label">
                                <input type="checkbox" id="loginRemember" name="remember" value="1">
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-text">Keep me logged in</span>
                            </label>
                        </div>

                        <!-- Error Message -->
                        <div id="loginModalError" class="login-modal__error" role="alert" aria-live="polite"></div>

                        <!-- Submit Button -->
                        <button type="submit" class="btn btn--primary btn--full" id="loginModalBtn">
                            Sign In
                        </button>
                    </form>

                    <footer class="login-modal__footer">
                        <a href="/forgot_password" class="link">Forgot password?</a>
                        <span class="login-modal__divider">|</span>
                        <a href="/sign_up" class="link">Create account</a>
                    </footer>
                </div>
            </div>
        `),this.modal=document.getElementById("loginModal")}init(){this.form=this.modal.querySelector("#loginModalForm");const e=this.modal.querySelector("#loginEmail"),t=this.modal.querySelector("#loginPassword"),a=this.modal.querySelector("#loginEmailFeedback"),s=this.modal.querySelector("#loginPasswordFeedback"),n=this.modal.querySelector("#loginPasswordToggle");this.validator=new g({validateOnInput:!0}),this.validator.bindInput(e,"email",a),this.validator.bindInput(t,"password",s),this.passwordToggle=new m(t,n),this.setupEventListeners()}setupEventListeners(){this.modal.addEventListener("click",e=>{e.target.closest('[data-action="close"]')&&this.hide()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&this.isVisible()&&this.hide()}),this.form.addEventListener("submit",e=>this.handleSubmit(e))}async handleSubmit(e){if(e.preventDefault(),this.isSubmitting||!this.validator.validateAll())return;this.isSubmitting=!0,this.setLoading(!0),this.hideError();const t={email:this.form.querySelector("#loginEmail").value.trim(),password:this.form.querySelector("#loginPassword").value,remember:this.form.querySelector("#loginRemember").checked};try{const a=await fetch(`${this.options.baseUrl}/api/v1/auth/sign-in`,{method:"POST",headers:h(),body:JSON.stringify(t)}),s=await a.json();if(a.ok){if(s.token){const n=t.remember?2592e3:604800;document.cookie=`auth_token=${s.token}; path=/; max-age=${n}; SameSite=Strict`}this.options.showToast&&this.options.showToast("Sign in successful!","success"),this.options.onSuccess&&this.options.onSuccess(s),this.options.redirectAfterLogin?setTimeout(()=>{window.location.href=this.options.redirectUrl},500):setTimeout(()=>{window.location.reload()},500),this.hide()}else this.showError(s.message||"Sign in failed. Please check your credentials."),this.options.onError&&this.options.onError(s)}catch(a){console.error("Login error:",a),this.showError("Network error. Please try again."),this.options.onError&&this.options.onError({message:"Network error"})}finally{this.isSubmitting=!1,this.setLoading(!1)}}setLoading(e){const t=this.form.querySelector("#loginModalBtn");t&&(t.disabled=e,t.textContent=e?"Signing in...":"Sign In")}showError(e){const t=this.modal.querySelector("#loginModalError");t&&(t.textContent=e,t.style.display="block")}hideError(){const e=this.modal.querySelector("#loginModalError");e&&(e.style.display="none")}show(){this.modal.classList.add("login-modal--visible"),document.body.style.overflow="hidden",setTimeout(()=>{const e=this.form.querySelector("input");e&&e.focus()},100)}hide(){this.modal.classList.remove("login-modal--visible"),document.body.style.overflow="",this.form.reset(),this.validator.reset(),this.hideError()}isVisible(){return this.modal.classList.contains("login-modal--visible")}destroy(){this.modal&&this.modal.remove()}}class b{constructor(e={}){this.defaultLocale=e.defaultLocale||"en_US",this.cookieName=e.cookieName||"blazing_sun_locale",this.cache=new Map,this.currentLocale=this.getLocaleFromCookie()||this.defaultLocale}getLocaleFromCookie(){const e=document.cookie.match(new RegExp(`${this.cookieName}=([^;]+)`));return e?decodeURIComponent(e[1]):null}setLocale(e){e&&(this.currentLocale=e,document.cookie=`${this.cookieName}=${encodeURIComponent(e)}; path=/; max-age=31536000; SameSite=Lax`,this.loadLocale(e))}async loadLocale(e){const t=e||this.currentLocale||this.defaultLocale;if(this.cache.has(t))return this.cache.get(t);try{const a=await fetch(`/localizations/${encodeURIComponent(t)}.json`,{credentials:"include"});if(!a.ok)throw new Error("Locale not found");const s=await a.json();return this.cache.set(t,s),s}catch{return t!==this.defaultLocale?this.loadLocale(this.defaultLocale):(this.cache.set(t,{}),{})}}translate(e,t={},a){let s={},n="singular";typeof t=="string"?n=t:typeof t=="object"&&t!==null&&(s=t),typeof a=="string"&&(n=a);const i=this.currentLocale||this.defaultLocale,r=this.cache.get(i)||this.cache.get(this.defaultLocale);if(!r)return this.loadLocale(i),e;const l=r[e];if(!l)return e;const d=n==="plural"?l.plural:l.singular;return this.replaceParams(d||e,s)}replaceParams(e,t){return!e||!t?e||"":e.replace(/##(.*?)##/g,(a,s)=>Object.prototype.hasOwnProperty.call(t,s)?String(t[s]):a)}}class f{constructor(e={}){this.containerId=e.containerId||"languageDropdown",this.languagesTableId=e.languagesTableId||"languagesTable",this.localizationManager=e.localizationManager||window.Blazing_Sun?.localization,this.onLanguageChange=e.onLanguageChange||null,this.container=null,this.languages=[],this.hreflangs=new Map,this.currentLanguage=null,this.isOpen=!1,this.init()}init(){if(this.container=document.getElementById(this.containerId),!this.container){console.warn(`[LanguageDropdown] Container #${this.containerId} not found`);return}this.loadLanguages(),this.loadHreflangs(),this.detectCurrentLanguage(),this.render(),this.bindEvents()}loadLanguages(){const e=document.getElementById(this.languagesTableId);if(!e){console.warn(`[LanguageDropdown] Languages table #${this.languagesTableId} not found`),this.languages=[{code:"en_US",name:"English",nativeName:"English",flag:"us"},{code:"es_ES",name:"Spanish",nativeName:"Español",flag:"es"},{code:"de_DE",name:"German",nativeName:"Deutsch",flag:"de"},{code:"fr_FR",name:"French",nativeName:"Français",flag:"fr"}];return}try{const t=e.textContent?.trim();if(t&&t.startsWith("[")){this.languages=JSON.parse(t);return}}catch{}if(e.dataset.languages)try{this.languages=JSON.parse(e.dataset.languages);return}catch(t){console.error("[LanguageDropdown] Failed to parse data-languages:",t)}if(e.tagName==="TABLE"){const t=e.querySelectorAll("tbody tr");this.languages=Array.from(t).map(a=>{const s=a.querySelectorAll("td");return{code:s[0]?.textContent?.trim()||a.dataset.code,name:s[1]?.textContent?.trim()||a.dataset.name,nativeName:s[2]?.textContent?.trim()||a.dataset.nativeName,flag:s[3]?.textContent?.trim()||a.dataset.flag}}).filter(a=>a.code);return}if(e.tagName==="UL"||e.tagName==="OL"){const t=e.querySelectorAll("li");this.languages=Array.from(t).map(a=>({code:a.dataset.code||a.dataset.locale,name:a.dataset.name||a.textContent?.trim(),nativeName:a.dataset.nativeName||a.dataset.native,flag:a.dataset.flag||a.dataset.country,iconUrl:a.dataset.iconUrl,selected:a.dataset.selected==="true"})).filter(a=>a.code);return}if(e.tagName==="SELECT"){const t=e.querySelectorAll("option");this.languages=Array.from(t).filter(a=>a.value).map(a=>({code:a.value,name:a.textContent?.trim(),nativeName:a.dataset.nativeName||a.textContent?.trim(),flag:a.dataset.flag}));return}console.warn("[LanguageDropdown] Could not parse languages from table")}loadHreflangs(){document.querySelectorAll('link[rel="alternate"][hreflang]').forEach(t=>{const a=t.getAttribute("hreflang"),s=t.getAttribute("href");if(a&&s){const n=this.normalizeLocaleCode(a);this.hreflangs.set(n,s);const i=a.split("-")[0];this.hreflangs.has(i)||this.hreflangs.set(i,s)}})}normalizeLocaleCode(e){return e?e.replace("-","_"):""}detectCurrentLanguage(){const e=this.languages.find(s=>s.selected);if(e){this.currentLanguage=e;return}if(this.localizationManager?.currentLocale&&(this.currentLanguage=this.findLanguageByCode(this.localizationManager.currentLocale),this.currentLanguage))return;const t=document.documentElement.lang;if(t&&(this.currentLanguage=this.findLanguageByCode(t),this.currentLanguage))return;const a=this.getCookieLocale();a&&(this.currentLanguage=this.findLanguageByCode(a),this.currentLanguage)||(this.currentLanguage=this.languages.find(s=>s.code.startsWith("en"))||this.languages[0])}findLanguageByCode(e){if(!e)return null;const t=this.normalizeLocaleCode(e),a=e.split(/[-_]/)[0].toLowerCase();let s=this.languages.find(n=>n.code===t||n.code===e);return s||(s=this.languages.find(n=>n.code.toLowerCase()===t.toLowerCase()),s)?s:(s=this.languages.find(n=>n.code.toLowerCase().startsWith(a)),s||null)}getCookieLocale(){const e=this.localizationManager?.cookieName||"blazing_sun_locale",t=document.cookie.match(new RegExp(`${e}=([^;]+)`));return t?decodeURIComponent(t[1]):null}render(){if(!this.container)return;const e=this.currentLanguage||this.languages[0];e&&(this.container.innerHTML=`
      <div class="language-dropdown">
        <button class="language-dropdown__trigger"
                type="button"
                aria-haspopup="listbox"
                aria-expanded="false"
                aria-label="Select language">
          ${this.renderFlag(e.flag,e.iconUrl)}
          <span class="language-dropdown__current">${e.nativeName||e.name}</span>
          <svg class="language-dropdown__arrow" width="12" height="12" viewBox="0 0 12 12" fill="none">
            <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        <ul class="language-dropdown__menu" role="listbox" aria-label="Available languages">
          ${this.languages.map(t=>this.renderLanguageOption(t,e)).join("")}
        </ul>
      </div>
    `,this.dropdownEl=this.container.querySelector(".language-dropdown"),this.triggerEl=this.container.querySelector(".language-dropdown__trigger"),this.menuEl=this.container.querySelector(".language-dropdown__menu"))}renderFlag(e,t){if(t)return`<img src="${t}" alt="" class="language-dropdown__flag language-dropdown__flag--image" aria-hidden="true" loading="lazy">`;if(e){const a=this.getFlagEmoji(e);if(a)return`<span class="language-dropdown__flag" aria-hidden="true">${a}</span>`}return""}getFlagEmoji(e){if(!e||e.length!==2)return"";const t=e.toUpperCase(),a=127397;return String.fromCodePoint(...[...t].map(s=>s.charCodeAt(0)+a))}renderLanguageOption(e,t){const a=e.code===t?.code,s=this.getHreflangUrl(e.code);return`
      <li class="language-dropdown__item ${a?"language-dropdown__item--selected":""}"
          role="option"
          aria-selected="${a}"
          data-code="${e.code}"
          ${s?`data-href="${s}"`:""}
          tabindex="0">
        ${this.renderFlag(e.flag,e.iconUrl)}
        <span class="language-dropdown__name">${e.nativeName||e.name}</span>
        ${a?'<svg class="language-dropdown__check" width="16" height="16" viewBox="0 0 16 16"><path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>':""}
      </li>
    `}getHreflangUrl(e){if(this.hreflangs.has(e))return this.hreflangs.get(e);const t=this.normalizeLocaleCode(e);if(this.hreflangs.has(t))return this.hreflangs.get(t);const a=e.split(/[-_]/)[0].toLowerCase();return this.hreflangs.has(a)?this.hreflangs.get(a):this.constructLanguageUrl(a)}constructLanguageUrl(e){const a=window.location.pathname.split("/").filter(n=>n);a.length>0&&/^[a-z]{2}$/i.test(a[0])?a[0]=e:a.unshift(e);const s="/"+a.join("/");return window.location.origin+s+window.location.search}bindEvents(){!this.triggerEl||!this.menuEl||(this.triggerEl.addEventListener("click",e=>{e.stopPropagation(),this.toggle()}),document.addEventListener("click",e=>{this.container?.contains(e.target)||this.close()}),this.container.addEventListener("keydown",e=>this.handleKeydown(e)),this.menuEl.querySelectorAll(".language-dropdown__item").forEach(e=>{e.addEventListener("click",()=>this.selectLanguage(e)),e.addEventListener("keydown",t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),this.selectLanguage(e))})}))}handleKeydown(e){switch(e.key){case"Escape":this.close(),this.triggerEl?.focus();break;case"ArrowDown":e.preventDefault(),this.isOpen?this.focusNextItem():this.open();break;case"ArrowUp":e.preventDefault(),this.isOpen&&this.focusPrevItem();break;case"Home":this.isOpen&&(e.preventDefault(),this.focusFirstItem());break;case"End":this.isOpen&&(e.preventDefault(),this.focusLastItem());break}}focusNextItem(){const e=Array.from(this.menuEl?.querySelectorAll(".language-dropdown__item")||[]),t=document.activeElement,a=e.indexOf(t);e[(a+1)%e.length]?.focus()}focusPrevItem(){const e=Array.from(this.menuEl?.querySelectorAll(".language-dropdown__item")||[]),t=document.activeElement,a=e.indexOf(t);e[(a-1+e.length)%e.length]?.focus()}focusFirstItem(){this.menuEl?.querySelector(".language-dropdown__item")?.focus()}focusLastItem(){const e=this.menuEl?.querySelectorAll(".language-dropdown__item");e?.[e.length-1]?.focus()}toggle(){this.isOpen?this.close():this.open()}open(){if(!this.dropdownEl)return;this.isOpen=!0,this.dropdownEl.classList.add("language-dropdown--open"),this.triggerEl?.setAttribute("aria-expanded","true"),(this.menuEl?.querySelector(".language-dropdown__item--selected")||this.menuEl?.querySelector(".language-dropdown__item"))?.focus()}close(){this.dropdownEl&&(this.isOpen=!1,this.dropdownEl.classList.remove("language-dropdown--open"),this.triggerEl?.setAttribute("aria-expanded","false"))}selectLanguage(e){const t=e.dataset.code,a=e.dataset.href;if(t){if(a){window.location.href=a;return}this.currentLanguage=this.findLanguageByCode(t),this.localizationManager&&this.localizationManager.setLocale(t),this.render(),this.bindEvents(),this.onLanguageChange&&this.onLanguageChange(t,this.currentLanguage),this.container?.dispatchEvent(new CustomEvent("languagechange",{bubbles:!0,detail:{code:t,language:this.currentLanguage}})),this.translatePage()}}translatePage(){document.querySelectorAll("[data-translate]").forEach(t=>{const a=t.dataset.translate,s=t.dataset.translateForm||"singular",n=t.dataset.translateArgs?JSON.parse(t.dataset.translateArgs):{},i=window.translate?.(a,n,s)||a;t.dataset.translateAttr?t.setAttribute(t.dataset.translateAttr,i):t.textContent=i}),document.querySelectorAll("[data-translate-placeholder]").forEach(t=>{const a=t.dataset.translatePlaceholder;t.placeholder=window.translate?.(a)||a}),document.querySelectorAll("[data-translate-title]").forEach(t=>{const a=t.dataset.translateTitle;t.title=window.translate?.(a)||a})}setLanguage(e){const t=this.menuEl?.querySelector(`[data-code="${e}"]`);t&&this.selectLanguage(t)}getCurrentLanguage(){return this.currentLanguage?.code||null}hasHreflangs(){return this.hreflangs.size>0}refresh(){this.loadLanguages(),this.loadHreflangs(),this.detectCurrentLanguage(),this.render(),this.bindEvents()}}document.addEventListener("DOMContentLoaded",()=>{window.Blazing_Sun=window.Blazing_Sun||{},window.Blazing_Sun.theme=new v,window.Blazing_Sun.navbar=new L,window.Blazing_Sun.csrf={getCsrfToken:u,getCsrfHeaders:h},window.Blazing_Sun.FormValidator=g,window.Blazing_Sun.PasswordToggle=m,window.Blazing_Sun.LoginModal=E,window.Blazing_Sun.localization=new b({defaultLocale:"en_US"}),window.Blazing_Sun.localization.loadLocale(),window.translate=(...e)=>window.Blazing_Sun.localization.translate(...e),document.getElementById("languageDropdown")&&(window.Blazing_Sun.languageDropdown=new f({containerId:"languageDropdown",languagesTableId:"languageDropdownData",localizationManager:window.Blazing_Sun.localization,onLanguageChange:(e,t)=>{console.log(`[LanguageDropdown] Language changed to: ${e}`,t)}})),window.Blazing_Sun.LanguageDropdown=f})})();
